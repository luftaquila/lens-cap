<html>

<head>
  <title>Lens cap generator</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Lens cap generator">
  <link href="https://unpkg.com/slim-select@latest/dist/slimselect.css" rel="stylesheet" />
</head>

<body>
  <script src="https://unpkg.com/slim-select@latest/dist/slimselect.min.js"></script>
  <script src="https://unpkg.com/three@latest/build/three.module.min.js"></script>
  <script type="module">
    import OpenSCAD from "./openscad.wasm.js";

    (async () => {
      try {
        const instance = await OpenSCAD({
          noInitialRun: true,
          locateFile: (path) => new URL(path, import.meta.url).href,
        });

        instance.FS.writeFile("/input.scad", "cube(10);");
        instance.callMain(["/input.scad", "-o", "cube.stl"]);
        const output = instance.FS.readFile("/cube.stl");
        const a = document.createElement("a");
        a.href = URL.createObjectURL(new Blob([output], {type: "application/octet-stream"}));
        a.download = "cube.stl";
        document.body.append(a);
        a.click();
      } catch (e) {
        console.error("OpenSCAD init failed:", e);
      }
    })();
  </script>


</body>

</html>
